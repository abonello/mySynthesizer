<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Synthesizer</title>
    <link rel="stylesheet" href="CSS/style.css">
</head>
<body>
    <h1>The Syntesizer</h1>
    <p>Programmed by <strong>Anthony Bonello</strong>, 2018.</p>
    <svg width="1112" height="600" style="background-color:aqua" onload="makeDraggable(evt)">
        <g id="Keyboard">
            <rect id="background" x="5" y="20" width="1102" height="400" fill="#535353" />
            <g id="whiteKeys">
                <rect id="noteC" x="5" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteD" x="97" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteE" x="189" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteF" x="281" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteG" x="373" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteA" x="465" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteB" x="557" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteC2" x="649" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteD2" x="741" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteE2" x="833" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteF2" x="925" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
                <rect id="noteG2" x="1017" y="20" rx="15" ry="7" width="90" height="400" fill="white"/>
            </g>
            <g id="blackKeys">
                <g id="noteCsharp" transform="translate(50,0)">
                    <image id="imgCsharp" xlink:href="BlackKey2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" />
                    <image id="imgCsharpPressed" class="blackKey" xlink:href="BlackKeyPressed2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" opacity="0"/>
                </g>
                <g id="noteDsharp" transform="translate(164,0)">
                    <image xlink:href="BlackKey2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" />
                    <image id="imgDsharpPressed" class="blackKey" xlink:href="BlackKeyPressed2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" opacity="0"/>
                </g>

                <g id="noteFsharp" transform="translate(321,0)">
                    <image xlink:href="BlackKey2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" />
                    <image id="imgFsharpPressed" class="blackKey" xlink:href="BlackKeyPressed2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" opacity="0"/>
                </g>
                <g id="noteGsharp" transform="translate(428,0)">
                    <image xlink:href="BlackKey2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" />
                    <image id="imgGsharpPressed" class="blackKey" xlink:href="BlackKeyPressed2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" opacity="0"/>
                </g>
                <g id="noteAsharp" transform="translate(535,0)">
                    <image xlink:href="BlackKey2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" />
                    <image id="imgAsharpPressed" class="blackKey" xlink:href="BlackKeyPressed2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" opacity="0"/>
                </g>

                <g id="noteC2sharp" transform="translate(699,0)">
                    <image xlink:href="BlackKey2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" />
                    <image id="imgC2sharpPressed" class="blackKey" xlink:href="BlackKeyPressed2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" opacity="0"/>
                </g>
                <g id="noteD2sharp" transform="translate(808,0)">
                    <image xlink:href="BlackKey2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" />
                    <image id="imgD2sharpPressed" class="blackKey" xlink:href="BlackKeyPressed2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" opacity="0"/>
                </g>

                <g id="noteF2sharp" transform="translate(965,0)">
                    <image xlink:href="BlackKey2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" />
                    <image id="imgF2sharpPressed" class="blackKey" xlink:href="BlackKeyPressed2small.png" x="-7" y="25" height="250px" width="60px" 
                    transform="scale(1.5, 1.1)" opacity="0"/>
                </g>
            </g>
            <rect id="velvet" x="5" y="20" width="1102" height="7" fill="#aa173b" />
        </g>

        <g id="stave">
            <line id="line5" x1="20" y1="500" x2="250" y2="500" stroke="black" stroke-width="3px" />
            <line id="line4" x1="20" y1="515" x2="250" y2="515" stroke="black" stroke-width="3px" />
            <line id="line3" x1="20" y1="530" x2="250" y2="530" stroke="black" stroke-width="3px" />
            <line id="line2" x1="20" y1="545" x2="250" y2="545" stroke="black" stroke-width="3px" />
            <line id="line1" x1="20" y1="560" x2="250" y2="560" stroke="black" stroke-width="3px" />
            <line id="finalBarLine1" x1="240" y1="500" x2="240" y2="560" stroke="black" stroke-width="3px" />
            <line id="finalBarLine2" x1="247" y1="500" x2="247" y2="560" stroke="black" stroke-width="6px" />
        </g>

        <g id="trebleClef3" transform="translate(-30,465) scale(1.7)">
                <path
                style="fill:black;fill-rule:nonzero;stroke:black;stroke-width:0.1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:1"
                d="M 39.638014,63.891442 C 39.246174,65.983409 41.499606,70.115061 45.890584,70.256984 C 51.19892,70.428558 54.590321,66.367906 53.010333,59.740875 L 45.086538,23.171517 C 44.143281,18.81826 44.851281,16.457097 45.354941,15.049945 C 46.698676,11.295749 50.055822,9.7473042 50.873134,10.949208 C 51.339763,11.635413 52.468042,14.844006 49.256275,20.590821 C 46.751378,25.072835 35.096985,30.950138 34.2417,41.468011 C 33.501282,50.614249 43.075689,57.369301 51.339266,54.71374 C 56.825686,52.950639 59.653965,44.62402 56.258057,40.328987 C 47.29624,28.994371 32.923702,46.341263 46.846564,51.0935 C 45.332604,49.90238 44.300646,48.980054 44.1085,47.852721 C 42.237755,36.876941 58.741182,39.774741 54.294493,50.18735 C 52.466001,54.469045 45.080341,55.297323 40.874269,51.477433 C 37.350853,48.277521 35.787387,42.113231 39.708327,37.687888 C 45.018831,31.694223 51.288782,26.31366 52.954064,18.108736 C 54.923313,8.4061491 48.493821,0.84188926 44.429027,10.385835 C 43.065093,13.588288 42.557016,16.803074 43.863006,22.963534 L 51.780549,60.311215 C 52.347386,62.985028 51.967911,66.664419 49.472374,68.355474 C 48.236187,69.193154 43.861784,69.769668 42.791575,67.770092"
                id="path1947"
                sodipodi:nodetypes="cssssssssscsssssssssc" />
             <path
                sodipodi:type="arc"
                style="fill:black;fill-opacity:1;stroke:black;stroke-width:0.09213948;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                id="path4608"
                sodipodi:cx="44.809425"
                sodipodi:cy="64.584198"
                sodipodi:rx="3.439605"
                sodipodi:ry="3.4987047"
                d="M 48.24903 64.584198 A 3.439605 3.4987047 0 1 1  41.36982,64.584198 A 3.439605 3.4987047 0 1 1  48.24903 64.584198 z"
                transform="matrix(-1.08512,-2.036848e-2,2.036848e-2,-1.08512,90.68868,135.0572)" />
        </g>

        <g id="mysemibreve" transform="translate(140,527) scale(0.58)">
            <path
            style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:3.5999999;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
            d="M 19.3125,126.90625 C 8.64348,126.90625 0,132.10043 0,138.46875 0,144.83708 8.64349,150.00003 19.3125,150 c 10.66902,0 19.34374,-5.16292 19.34375,-11.53125 0,-6.36833 -8.67473,-11.56252 -19.34375,-11.5625 z M 14.59375,129 c 2.77434,-0.0361 6.19235,1.04942 9.40625,3.21875 5.7136,3.85657 8.58014,9.6647 6.40625,12.9375 -2.17388,3.27282 -8.56765,2.79408 -14.28125,-1.0625 -5.71359,-3.85657 -8.58014,-9.6647 -6.4062503,-12.9375 C 10.66983,129.72439 12.43593,129.02807 14.59375,129 Z"/>
        </g>

        <g id="sharpsign" transform="translate(0,100) scale(1.5)" >
            <path
                d="M 86.102000,447.45700 L 86.102000,442.75300 L 88.102000,442.20100 L 88.102000,446.88100 L 86.102000,447.45700 z M 90.040000,446.31900 L 88.665000,446.71300 L 88.665000,442.03300 L 90.040000,441.64900 L 90.040000,439.70500 L 88.665000,440.08900 L 88.665000,435.30723 L 88.102000,435.30723 L 88.102000,440.23400 L 86.102000,440.80900 L 86.102000,436.15923 L 85.571000,436.15923 L 85.571000,440.98600 L 84.196000,441.37100 L 84.196000,443.31900 L 85.571000,442.93500 L 85.571000,447.60600 L 84.196000,447.98900 L 84.196000,449.92900 L 85.571000,449.54500 L 85.571000,454.29977 L 86.102000,454.29977 L 86.102000,449.37500 L 88.102000,448.82500 L 88.102000,453.45077 L 88.665000,453.45077 L 88.665000,448.65100 L 90.040000,448.26600 L 90.040000,446.31900 z "
                style="fill:#000000" />
        </g>

        <line id="ledgerline" x1="136" y1="620" x2="166" y2="620" stroke="black" stroke-width="3" fill="none"/>
        <g id="slider" transform="translate(300, 475)">
            <!-- <line id="volSliderRail" x1="0" y1="0" x2="0" y2="100" stroke="black" stroke-width="3" fill="none"/> -->
            <line x1="-5" y1="98" x2="8" y2="98" stroke="black" stroke-width="1" fill="none" />
            <line x1="-5" y1="50" x2="8" y2="50" stroke="black" stroke-width="1" fill="none" />
            <line x1="-5" y1="2" x2="8" y2="2" stroke="black" stroke-width="1" fill="none" />
            <rect id="volSliderRail" x="0" y="0" width="3" height="100" stroke="powderblue" stroke-width="2" fill="dark-grey" />
            <rect id="volSlider" x="-10" y="0" rx="7" ry="3" class="draggable"
            width="23" height="7" stroke="black" stroke-width="2" fill="cadetblue"  />
            <text x="-26" y="117">Volume</text>
        </g>
    </svg>

    <!-- <input id="testSlider" type="range" orient="vertical"> Not currently implemented -->

    <div id="wavType">
        <strong>Wave Type</strong><br>
        <input id="sine" onchange="changeType()" type="radio" name="waveform" checked value="sine">Sine (V)<br>
        <input id="sawtooth" onchange="changeType()" type="radio" name="waveform" value="sawtooth">Sawtooth (B)<br>
        <input id="triangle" onchange="changeType()" type="radio" name="waveform" value="triangle">Triangle (N)<br>
        <input id="square" onchange="changeType()" type="radio" name="waveform" value="square">Square (M)
    </div>

    <h3>GUI Keyboard:</h3>
    <p id="answer"> </p>
    <h3>Computer Keyboard:</h3>
    <p id="keyPressed"> </p>

    <script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous">
    </script>
    
    
    <script>
        var notes = {
            "C": { "text": "C", "position": 494, "frequency": 261.626, "sharpPosition": 100 },
            "Csharp": { "text": "C♯ / D♭", "position": 494, "frequency": 277.183, "sharpPosition": -90 },
            "D": { "text": "D", "position": 487, "frequency": 293.665, "sharpPosition": 100 },
            "Dsharp": { "text": "D♯ / E♭", "position": 487, "frequency": 311.127, "sharpPosition": -98 },
            "E": { "text": "E", "position": 479, "frequency": 329.628, "sharpPosition": 100 },
            "F": { "text": "F", "position": 472, "frequency": 349.228, "sharpPosition": 100 },
            "Fsharp": { "text": "F♯ / G♭", "position": 472, "frequency": 369.994, "sharpPosition": -115 },
            "G": { "text": "G", "position": 464, "frequency": 391.995, "sharpPosition": 100 },
            "Gsharp": { "text": "G♯ / A♭", "position": 464, "frequency": 415.305, "sharpPosition":  -122},
            "A": { "text": "A", "position": 457, "frequency": 440.000, "sharpPosition": 100 },
            "Asharp": { "text": "A♯ / B♭", "position": 457, "frequency": 466.164, "sharpPosition": -130 },
            "B": { "text": "B", "position": 449, "frequency": 493.883, "sharpPosition": 100 },
            "C2": { "text": "C'", "position": 442, "frequency": 523.251, "sharpPosition": 100 },
            "C2sharp": { "text": "C♯ / D♭", "position": 442, "frequency": 554.365, "sharpPosition": -145 },
            "D2": { "text": "D'", "position": 434, "frequency": 587.330, "sharpPosition": 100 },
            "D2sharp": { "text": "D♯ / E♭", "position": 434, "frequency": 622.254, "sharpPosition": -152 },
            "E2": { "text": "E'", "position": 427, "frequency": 659.255, "sharpPosition": 100 },
            "F2": { "text": "F'", "position": 419, "frequency": 698.456, "sharpPosition": 100 },
            "F2sharp": { "text": "F♯ / G♭", "position": 419, "frequency": 739.989, "sharpPosition": -167 },
            "G2": { "text": "G'", "position": 412, "frequency": 783.991, "sharpPosition": 100 }
        }

        function clickNote(arg) {
            var text = arg.id + " ";
            text = text.slice(4, -1);
            $("#answer").text(notes[text]["text"]);
            var trans = "translate(140px, "+ notes[text]['position']+ "px) scale(0.58)"
            $("#mysemibreve").css("transform", trans);
            if (text == "C" || text == "Csharp") { ledgerLinePos = 575; } 
            else { ledgerLinePos = 620; }
            $("#ledgerline")
                .attr('y1', function () { return ledgerLinePos; })
                .attr('y2', function () { return ledgerLinePos; });
            var sharpPos = "translate(0px, "+ notes[text]['sharpPosition']+ "px) scale(1.5)"
            $("#sharpsign").css("transform",sharpPos);
            $(".blackKey").css("opacity", "0");
            var freq = notes[text]["frequency"]
            playSynth(freq);
        }

        // GUI Keyboard respond to clicks
        $("#noteC").click(function() {
            clickNote(this);
        });
        $("#noteCsharp").click(function() {
            clickNote(this);
            $("#imgCsharpPressed").css("opacity", "1");
        });
        $("#noteD").click(function() {
            clickNote(this);
        });
        $("#noteDsharp").click(function() {
            clickNote(this);
            $("#imgDsharpPressed").css("opacity", "1");
        });
        $("#noteE").click(function() {
            clickNote(this);
        });
        $("#noteF").click(function() {
            clickNote(this);
        });
        $("#noteFsharp").click(function() {
            clickNote(this);
            $("#imgFsharpPressed").css("opacity", "1");
        });
        $("#noteG").click(function() {
            clickNote(this);
        });
        $("#noteGsharp").click(function() {
            clickNote(this);
            $("#imgGsharpPressed").css("opacity", "1");
        });
        $("#noteA").click(function() {
            clickNote(this);
        });
        $("#noteAsharp").click(function() {
            clickNote(this);
            $("#imgAsharpPressed").css("opacity", "1");
        });
        $("#noteB").click(function() {
            clickNote(this);
        });
        $("#noteC2").click(function() {
            clickNote(this);
        });
        $("#noteC2sharp").click(function() {
            clickNote(this);
            $("#imgC2sharpPressed").css("opacity", "1");
        });
        $("#noteD2").click(function() {
            clickNote(this);
        });
        $("#noteD2sharp").click(function() {
            clickNote(this);
            $("#imgD2sharpPressed").css("opacity", "1");
        });
        $("#noteE2").click(function() {
            clickNote(this);
        });
        $("#noteF2").click(function() {
            clickNote(this);
        });
        $("#noteF2sharp").click(function() {
            clickNote(this);
            $("#imgF2sharpPressed").css("opacity", "1");
        });
        $("#noteG2").click(function() {
            clickNote(this);
        });
        
        $("body").keyup(function(e){
            var code = e.keyCode || e.which;
            // alert(code);
            if(code == 97 || code == 65) { $("#noteC").toggleClass("hovered"); }
            else if(code == 87 || code == 119) {$("#noteCsharp").children().toggleClass("hovered"); }
            else if(code == 115 || code == 83) { $("#noteD").toggleClass("hovered"); }
            else if(code == 69 || code == 101) {$("#noteDsharp").children().toggleClass("hovered"); }
            else if(code == 100 || code == 68) { $("#noteE").toggleClass("hovered"); }
            else if(code == 102 || code == 70) { $("#noteF").toggleClass("hovered"); }
            else if(code == 84 || code == 116) {$("#noteFsharp").children().toggleClass("hovered"); }
            else if(code == 103 || code == 71) { $("#noteG").toggleClass("hovered"); }
            else if(code == 89 || code == 121) {$("#noteGsharp").children().toggleClass("hovered"); }
            else if(code == 104 || code == 72) { $("#noteA").toggleClass("hovered"); }
            else if(code == 85 || code == 117) {$("#noteAsharp").children().toggleClass("hovered"); }
            else if(code == 106 || code == 74) { $("#noteB").toggleClass("hovered"); }
            else if(code == 107 || code == 75) { $("#noteC2").toggleClass("hovered"); }
            else if(code == 108 || code == 76) { $("#noteD2").toggleClass("hovered"); }
            else if(code == 186) { $("#noteE2").toggleClass("hovered"); }
            else if(code == 222) { $("#noteF2").toggleClass("hovered"); }
            else if(code == 220) { $("#noteG2").toggleClass("hovered");}
        });
        
        function pressedNote(arg) {
            // console.log(arg);
            // console.log(jQuery.type(arg));
            $(arg).toggleClass("hovered");
            var text = arg + " ";
            // console.log(text);
            text = text.slice(5, -1);
            // console.log(text);

            $("#keyPressed").text(notes[text]["text"]);
            var trans = "translate(140px, "+ notes[text]['position']+ "px) scale(0.58)"
            $("#mysemibreve").css("transform", trans);
            if (text == "C" || text == "Csharp") { ledgerLinePos = 575; } 
            else { ledgerLinePos = 620; }
            $("#ledgerline")
                .attr('y1', function () { return ledgerLinePos; })
                .attr('y2', function () { return ledgerLinePos; });
            var sharpPos = "translate(0px, "+ notes[text]['sharpPosition']+ "px) scale(1.5)"
            $("#sharpsign").css("transform",sharpPos);
            $(".blackKey").css("opacity", "0");
            var freq = notes[text]["frequency"]
            playSynth(freq);
        }

        $("body").keypress(function(e) {
            // console.log( "Handler for .keypress() called." );
            var code = e.keyCode || e.which;
            // alert(code);
            if(code == 97 || code == 65) { pressedNote("#noteC"); }  
            else if(code == 87 || code == 119) { 
                pressedNote("#noteCsharp");
                $("#imgCsharpPressed").css("opacity", "1");
            }     
            else if(code == 115 || code == 83) { pressedNote("#noteD"); }
            else if(code == 101 || code == 69) { 
                pressedNote("#noteDsharp");
                $("#imgDsharpPressed").css("opacity", "1");
            }
            else if(code == 100 || code == 68) { pressedNote("#noteE"); }
            else if(code == 102 || code == 70) { pressedNote("#noteF"); }
            else if(code == 116 || code == 84) { 
                pressedNote("#noteFsharp");
                $("#imgFsharpPressed").css("opacity", "1"); 
            }
            else if(code == 103 || code == 71) { pressedNote("#noteG"); }
            else if(code == 121 || code == 89) { 
                pressedNote("#noteGsharp");
                $("#imgGsharpPressed").css("opacity", "1"); 
            }
            else if(code == 104 || code == 72) { pressedNote("#noteA"); }
            else if(code == 117 || code == 85) { 
                pressedNote("#noteAsharp");
                $("#imgAsharpPressed").css("opacity", "1");
            }
            else if(code == 106 || code == 74) { pressedNote("#noteB"); }
            else if(code == 107 || code == 75) { pressedNote("#noteC2"); }
            else if(code == 79 || code == 111) { 
                pressedNote("#noteC2sharp");
                $("#imgC2sharpPressed").css("opacity", "1");
            }     
            else if(code == 108 || code == 76) { pressedNote("#noteD2"); }
            else if(code == 80 || code == 112) { 
                pressedNote("#noteD2sharp");
                $("#imgD2sharpPressed").css("opacity", "1");
            }  
            else if(code == 59 || code == 58) { pressedNote("#noteE2"); }
            else if(code == 39 || code == 34) { pressedNote("#noteF2"); }
            else if(code == 93 || code == 125) { 
                pressedNote("#noteF2sharp");
                $("#imgF2sharpPressed").css("opacity", "1");
            }  
            else if(code == 92 || code == 124) { pressedNote("#noteG2"); }

            if(code == 86 || code == 118) {
                var radiobtn = document.getElementById("sine");
                radiobtn.checked = true;
                changeType()
            }   
            else if(code == 66 || code == 98) {
                var radiobtn = document.getElementById("sawtooth");
                radiobtn.checked = true;
                changeType()
            }   
            else if(code == 78 || code == 110) {
                var radiobtn = document.getElementById("triangle");
                radiobtn.checked = true;
                changeType()
            }   
            else if(code == 77 || code == 109) {
                var radiobtn = document.getElementById("square");
                radiobtn.checked = true;
                changeType()
            }
        });

        // function releaseKeyCs() {

        //     $("#imgCsharpPressed").style.opacity = "0";
        // }
        // $("#noteCsharp").onkeyup = function() {
        //     $("#imgCsharpPressed").style.opacity = "0";
        // }
        window.addEventListener("keyup", releaseBlackKey, false);
        
        function releaseBlackKey(key) {
            console.log(key.keyCode);
            if(key.keyCode == 87 || key.keyCode == 119) {
                $("#imgCsharpPressed").css( "opacity", 0);
            }
            else if(key.keyCode == 101 || key.keyCode == 69) {
                $("#imgDsharpPressed").css( "opacity", 0);
            }

            else if(key.keyCode == 116 || key.keyCode == 84) {
                $("#imgFsharpPressed").css( "opacity", 0);
            }
            else if(key.keyCode == 121 || key.keyCode == 89) {
                $("#imgGsharpPressed").css( "opacity", 0);
            }
            else if(key.keyCode == 117 || key.keyCode == 85) {
                $("#imgAsharpPressed").css( "opacity", 0);
            }

            else if(key.keyCode == 79 || key.keyCode == 111) {
                $("#imgC2sharpPressed").css( "opacity", 0);
            }
            else if(key.keyCode == 80 || key.keyCode == 112) {
                $("#imgD2sharpPressed").css( "opacity", 0);
            }

            else if(key.keyCode == 221) {
                $("#imgF2sharpPressed").css( "opacity", 0);
            }
        }



        // $("volSlider").mousemove(function(e){
        //     console.log(e);
        // });

        // $("#volSlider").mousedown(function(e) {
        //     console.log(e);
        //     console.log(this.getBoundingClientRect()["y"]);
        //     var trackMouse = $("volSlider").mousemove();
        //     console.log(trackMouse);
            // $(this).mousemove();
            // $(this).attr('y', function () { return this.mousemove(); })
            // Example:
            // $('svg circle')[0].getBBox();
        // })
        
        var selectedElement = false;
        // For Volume Control - May be used for other things later.
        function makeDraggable(evt) {
            var svg = evt.target;
            svg.addEventListener('mousedown', startDrag);
            svg.addEventListener('mousemove', drag);
            svg.addEventListener('mouseup', endDrag);
            svg.addEventListener('mouseleave', endDrag);
            function startDrag(evt) {
                if (evt.target.classList.contains('draggable')) {
                    selectedElement = evt.target;
                }
            }
            function drag(evt) {
                if (selectedElement) {
                    evt.preventDefault();
                    var coord = getMousePosition(evt);
                    var y = coord.y;
                    var minY = 480;
                    var maxY = 575;
                    if (y < minY) { y = minY; }
                    if (y > maxY) { y = maxY; }
                    selectedElement.setAttributeNS(null, "y", y-minY);

                    // Calculate volume
                    volume = (maxY - y)/(maxY-minY)
                }
            }
            function endDrag(evt) {
                selectedElement = null;
            }
            function getMousePosition(evt) {
                var CTM = svg.getScreenCTM();
                return {
                    x: (evt.clientX - CTM.e) / CTM.a,
                    y: (evt.clientY - CTM.f) / CTM.d
                };
            }
        }

        var attack = 0.14; // default value
        var duration = 1.5; // default value
        var volume = 1;
        var type = "sine";

        
        // var audio_context = window.AudioContext || window.webkitAudioContext;
        // var con = new audio_context();
        var con = new AudioContext();
        
        // link widgets to their callback functions and set initial values
            // var setAttack;      // attack widget id
            // var setLength;      // length widget id
            // nx.onload = function() {
            //     setAttack.on('*', change_attack);
            //     setAttack.set({value: attack});
            //     setLength.on('*', change_duration);
            //     setLength.set({value: duration});
            // };
        
        function playSynth(frequency){
            var osc = con.createOscillator(); // create oscillator
            var amp = con.createGain(); // create gain
            
            // ENVELOPE
            
            var now = con.currentTime; // Find what the time is now. # sec elapse since start of run.
            amp.gain.setValueAtTime(0 * volume, now);
            amp.gain.linearRampToValueAtTime(0.3 * volume, now + (duration * attack));
            amp.gain.linearRampToValueAtTime(0.1 * volume, now + (2 * duration * attack));
            amp.gain.linearRampToValueAtTime(0.08 * volume, now + (3 * duration * attack));
            amp.gain.linearRampToValueAtTime(0 * volume, now + duration);
            
            
            
            //osc.type = 'square'; // wave form triangle, sine (default), square
            
            // osc.frequency.value = (Math.random() * 1000) + 100; // random frequencies
            osc.frequency.value = frequency; // Frequency controlled by key
            osc.type = type;
            osc.connect(amp);
            amp.connect(con.destination);
            osc.start();
            osc.stop(now + duration + 0.1);
        }
        
        // attack, decay & volume dial handlers
        function change_attack(data) { attack = data.value; }
        function change_duration(data) { duration = data.value; }
        function changeType() {
            type = document.querySelector("input[name='waveform']:checked").value;
            // console.log(type); 
            }

    </script>
    
</body>
</html>